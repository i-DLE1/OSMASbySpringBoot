<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.idle.osmas.seller.dao.SalesMapper">
    <resultMap type="com.idle.osmas.seller.dto.SalesDTO" id="salesResultMap">
        <id property="no" column="NO"/>
        <result property="title" column="TITLE"/>
        <result property="content" column="CONTENT"/>
        <result property="registDate" column="REGIST_DATE"/>
        <result property="startDate" column="START_DATE"/>
        <result property="endDate" column="END_DATE"/>
        <result property="targetAmount" column="TARGET_AMOUNT"/>
        <result property="currentAmount" column="CURRENT_AMOUNT"/>
        <result property="views" column="VIEWS"/>
        <result property="refMemberNo" column="REF_MEMBER_NO"/>
        <result property="refCategoryNo" column="REF_CATEGORY_NO"/>
    </resultMap>

    <resultMap type="com.idle.osmas.seller.dto.OptionDTO" id="optionResultMap">
        <id property="no" column="NO"/>
        <result property="name" column="NAME"/>
        <result property="introduction" column="INTRODUCTION"/>
        <result property="price" column="PRICE"/>
        <result property="maxQuantity" column="MAX_QUANTITY"/>
        <result property="status" column="STATUS"/>
        <result property="productSize" column="PRODUCT_SIZE"/>
    </resultMap>

    <resultMap type="com.idle.osmas.seller.dto.CategoryDTO" id="categoryResultMap">
        <id property="no" column="NO"/>
        <result property="subNo" column="SUB_NO"/>
        <result property="name" column="NAME"/>
    </resultMap>

    <select id="selectAllProject" resultMap="salesResultMap">
        SELECT
            NO,
            TITLE,
            CONTENT,
            REGIST_DATE,
            START_DATE,
            END_DATE,
            TARGET_AMOUNT,
            CURRENT_AMOUNT,
            VIEWS,
            REF_MEMBER_NO,
            REF_CATEGORY_NO
        FROM TBL_PRJ
    </select>

    <select id="selectProjectByNo" resultMap="salesResultMap" parameterType="_int">
        SELECT
            NO,
            TITLE,
            CONTENT,
            REGIST_DATE,
            START_DATE,
            END_DATE,
            TARGET_AMOUNT,
            CURRENT_AMOUNT,
            VIEWS,
            REF_MEMBER_NO,
            REF_CATEGORY_NO
        FROM TBL_PRJ
        WHERE NO = #{ no }
    </select>

    <select id="selectAllOption" resultMap="optionResultMap" >
        SELECT
            NO,
            NAME,
            INTRODUCTION,
            PRICE,
            MAX_QUANTITY,
            STATUS,
            PRODUCT_SIZE
        FROM TBL_PRODUCT
    </select>

    <select id="selectCategoryByNo" resultMap="categoryResultMap" parameterType="_int">
        SELECT
            NO,
            SUB_NO,
            NAME
        FROM TBL_CATEGORY
        WHERE NO = (SELECT
            REF_CATEGORY_NO
            FROM TBL_PRJ
            WHERE NO = #{ no })
    </select>

</mapper>